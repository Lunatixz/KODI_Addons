define(["./../../controllers/ptvl"],function(e){e.controller("subRulesCtrl",["$scope","ruleFactory",function(e,u){e.subsLocked=!0,isNaN(e.channel.channel)||(e.rules=u.getSubRules(e.channel.rules),"undefined"!=typeof e.rules[13].value.options[1]&&(e.rules[13].value.options[1]=parseInt(e.rules[13].value.options[1])/60)),e.wip=!0,e.unlockSubs=function(){e.subsLocked=!1},e.saveSubRules=function(){var u,s=e.rules,n=e.rules,l=0;for(u in n)n.hasOwnProperty(u)&&++l;for(s.length=l,e.rules.enabled=0,e.rules[13].value.options[1]=60*parseInt(e.rules[13].value.options[1]),s=0,n=1;n<e.rules.length;n++)void(!0===e.rules[n].status&&(e.rules.enabled++,s++,"undefined"!=typeof e.channel.rules.sub[s]?void 0:void(e.channel.rules.sub[s]={}),e.channel.rules.sub[s].id=e.rules[n].id.toString(),e.channel.rules.sub[s].options=jQuery.extend(!0,{},e.rules[n].value.options)));e.channel.rules.count=e.rules.enabled,e.subsLocked=!0}}])});